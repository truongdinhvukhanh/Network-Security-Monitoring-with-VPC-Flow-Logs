<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.134.2">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/Network-Security-Monitoring-with-VPC-Flow-Logs/images/favicon.png" type="image/png">

    <title>Create the Ingest Pipeline :: Create a new AWS account.</title>

    
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/nucleus.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/fontawesome-all.min.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/hybrid.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/featherlight.min.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/perfect-scrollbar.min.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/auto-complete.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/atom-one-dark-reasonable.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/theme.css?1754233304" rel="stylesheet">
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/hugo-theme.css?1754233304" rel="stylesheet">
    
    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/css/theme-workshop.css?1754233304" rel="stylesheet">
    
    

    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/jquery-3.3.1.min.js?1754233304"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/2-create-ingest-pipeline/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/lunr.min.js?1754233304"></script>
<script type="text/javascript" src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/auto-complete.js?1754233304"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/truongdinhvukhanh.github.io\/Network-Security-Monitoring-with-VPC-Flow-Logs\/";
    
</script>
<script type="text/javascript" src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/search.js?1754233304"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/1-introduction/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/1-introduction/">
           <b> 1. </b> Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/" title="Preparation" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/">
           <b> 2. </b> Preparation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/1-create-vpc/" title="Create VPC" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/1-create-vpc/">
           <b> 2.1 </b> Create VPC
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/2-create-subnets/" title="Create Subnets" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/2-create-subnets/">
           <b> 2.2 </b> Create Subnets
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/3-create-internet-gateway/" title="Create Internet Gateway" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/3-create-internet-gateway/">
           <b> 2.3 </b> Create Internet Gateway
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/4-create-route-table/" title="Create Route Table" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/4-create-route-table/">
           <b> 2.4 </b> Create Route Table
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/5-create-security-groups/" title="Create Security Groups" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/5-create-security-groups/">
           <b> 2.5 </b> Create Security Groups
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/6-create-iam-policy-and-iam-role/" title="Create IAM Policy and IAM Role" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/2-preparation/6-create-iam-policy-and-iam-role/">
           <b> 2.6 </b> Create IAM Policy and IAM Role
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/3-create-ec2-bastion/" title="Create EC2 Bastion" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/3-create-ec2-bastion/">
           <b> 3. </b> Create EC2 Bastion
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/3-create-ec2-bastion/1-launch-an-ec2-instance-as-a-bastion-host/" title="Launch an EC2 Instance as a Bastion Host" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/3-create-ec2-bastion/1-launch-an-ec2-instance-as-a-bastion-host/">
           <b> 3.1 </b> Launch an EC2 Instance as a Bastion Host
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/3-create-ec2-bastion/2-connect-to-the-bastion-host-via-ssh/" title="Connect to the Bastion Host via SSH" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/3-create-ec2-bastion/2-connect-to-the-bastion-host-via-ssh/">
           <b> 3.2 </b> Connect to the Bastion Host via SSH
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/4-create-s3-bucket/" title="Create S3 Bucket" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/4-create-s3-bucket/">
           <b> 4. </b> Create S3 Bucket
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/" title="Create and configure OpenSearch Service" class="dd-item 
        parent
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/">
           <b> 5. </b> Create and configure OpenSearch Service
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/1-create-opensearch-service-domain/" title="Create OpenSearch Service Domain" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/1-create-opensearch-service-domain/">
           <b> 5.1 </b> Create OpenSearch Service Domain
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/2-create-ingest-pipeline/" title="Create the Ingest Pipeline" class="dd-item 
        
        active
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/2-create-ingest-pipeline/">
           <b> 5.2 </b> Create the Ingest Pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/6-create-kinesis-data-firehose/" title="Create Kinesis Data Firehose" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/6-create-kinesis-data-firehose/">
           <b> 6. </b> Create Kinesis Data Firehose
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/7-create-vpc-flow-log/" title="Create VPC Flow Log" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/7-create-vpc-flow-log/">
           <b> 7. </b> Create VPC Flow Log
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/8-verify-data-flow-and-create-dashboard/" title="Verify data flow and create Dashboard" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/8-verify-data-flow-and-create-dashboard/">
           <b> 8. </b> Verify data flow and create Dashboard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/8-verify-data-flow-and-create-dashboard/1-verify-data-flow/" title="Verify data flow" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/8-verify-data-flow-and-create-dashboard/1-verify-data-flow/">
           <b> 8.1 </b> Verify data flow
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/8-verify-data-flow-and-create-dashboard/2-create-dashboard/" title="Create Dashboard" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/8-verify-data-flow-and-create-dashboard/2-create-dashboard/">
           <b> 8.2 </b> Create Dashboard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/9-query-logs-with-athena/" title="Query logs with Athena" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/9-query-logs-with-athena/">
           <b> 9. </b> Query logs with Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/Network-Security-Monitoring-with-VPC-Flow-Logs/10-clean-up-resources/" title="Clean up resources" class="dd-item 
        
        
        
        ">
      <a href="/Network-Security-Monitoring-with-VPC-Flow-Logs/10-clean-up-resources/">
           <b> 10. </b> Clean up resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://aws.amazon.com/blogs"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj"><i class='fab fa-facebook'></i> AWS Study Group - FB Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="https://truongdinhvukhanh.github.io/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/2-create-ingest-pipeline/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="https://truongdinhvukhanh.github.io/Network-Security-Monitoring-with-VPC-Flow-Logs/vi/5-create-and-configure-opensearch-service/2-create-ingest-pipeline/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830891&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>26-11-2023</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/Network-Security-Monitoring-with-VPC-Flow-Logs/'>Network Security Monitoring with VPC Flow Logs</a> > <a href='/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/'>Create and configure OpenSearch Service</a> > Create the Ingest Pipeline
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Create the Ingest Pipeline
            </h1>
          

        



	
<div class="notices note" ><p>This step is crucial for preparing your OpenSearch domain to properly ingest and analyze VPC Flow Log data. You will first verify access to OpenSearch Dashboards via an SSH tunnel through your Bastion Host. Following this, you will create and test an ingest pipeline (<strong>vpc-flow-log-pipeline</strong>). This pipeline uses a Grok processor to parse the raw, unstructured VPC Flow Log messages into distinct, searchable fields, making the data highly valuable for security analysis and network monitoring within OpenSearch.</p>
</div>

<h4 id="verify-access-to-opensearch-dashboards">Verify Access to OpenSearch Dashboards</h4>
<p>Now that your OpenSearch domain is active, you&rsquo;ll need to verify that you can access OpenSearch Dashboards.</p>
<ol>
<li>
<p><strong>Set Up SSH Tunnel to Access OpenSearch Dashboards</strong></p>
<ul>
<li><strong>Open a terminal or command prompt on your local machine</strong></li>
<li><strong>Create an SSH tunnel through your Bastion Host</strong>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>ssh -i <span style="color:#e6db74">&#34;your-key.pem&#34;</span> -L <span style="color:#ae81ff">9200</span><span style="color:#960050;background-color:#1e0010">:</span>your-opensearch-endpoint:<span style="color:#ae81ff">443</span> ec2-user@your-bastion-host-ip
</span></span></code></pre></div><ul>
<li>Replace <code>your-key.pem</code> with the path to your key file</li>
<li>Replace <code>your-opensearch-endpoint</code> with your OpenSearch domain endpoint (without <code>https://</code> and <code>/_dashboards</code>) that you copied in previous step         <br>
<img alt="image.png" src="../../images/5/5.2/image.png"></li>
<li>Replace <code>your-bastion-host-ip</code> with your Bastion Host&rsquo;s public IP     <br>
<img alt="image.png" src="../../images/5/5.2/image%201.png"></li>
</ul>
</li>
<li>Keep this terminal window open while you perform the following steps</li>
</ul>
</li>
<li>
<p><strong>Access OpenSearch Dashboards</strong></p>
<ul>
<li>Open your web browser, enter the URL: <code>https://localhost:9200/_dashboards/</code> <br>
<img alt="image.png" src="../../images/5/5.2/image%202.png"> <br>
<img alt="image.png" src="../../images/5/5.2/image%203.png"></li>
</ul>
</li>
<li>
<p><strong>Verify Your Admin Access</strong></p>
<ul>
<li><strong>Explore the OpenSearch Dashboards Interface</strong>
<ul>
<li>After logging in, you should see the OpenSearch Dashboards home page</li>
<li>Take a moment to familiarize yourself with the interface</li>
</ul>
</li>
<li><strong>Check Cluster Health</strong>
<ul>
<li>In the left navigation menu, click on <strong>Dev Tools</strong>       <br>
<img alt="image.png" src="../../images/5/5.2/image%204.png"></li>
<li>In the Console, run the following command:
<pre tabindex="0"><code>GET _cluster/health
</code></pre></li>
<li>The response should show the health status of your cluster (ideally &ldquo;green&rdquo;)         <br>
<img alt="image.png" src="../../images/5/5.2/image%205.png"></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Create the Ingest Pipeline <br>
Execute this command in the Dev Tools console to create your parsing pipeline:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">PUT</span> <span style="color:#960050;background-color:#1e0010">_ingest/pipeline/vpc-flow-log-pipeline</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Pipeline to parse VPC Flow Log data&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;processors&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;grok&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;field&#34;</span>: <span style="color:#e6db74">&#34;message&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;patterns&#34;</span>: [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;%{NUMBER:version:int} %{NUMBER:account_id} (%{NOTSPACE:interface_id}|-) (%{IP:srcaddr}|-) (%{IP:dstaddr}|-) (%{NUMBER:srcport:int}|-) (%{NUMBER:dstport:int}|-) (%{NUMBER:protocol:int}|-) (%{NUMBER:packets:int}|-) (%{NUMBER:bytes:long}|-) (%{NUMBER:start:long}|-) (%{NUMBER:end:long}|-) (%{WORD:action}|-) (%{WORD:log_status}|-)&#34;</span>
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;script&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Convert dash values to null&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;source&#34;</span>: <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          def fields = [&#39;interface_id&#39;, &#39;srcaddr&#39;, &#39;dstaddr&#39;, &#39;srcport&#39;, &#39;dstport&#39;, &#39;protocol&#39;, &#39;packets&#39;, &#39;bytes&#39;, &#39;start&#39;, &#39;end&#39;, &#39;action&#39;, &#39;log_status&#39;];
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          for (def field : fields) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            if (ctx.containsKey(field) &amp;&amp; ctx[field] == &#39;-&#39;) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              ctx[field] = null;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;remove&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;field&#34;</span>: <span style="color:#e6db74">&#34;message&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}    
</span></span></code></pre></div><p>This pipeline:</p>
<ul>
<li>Uses a <strong>Grok processor</strong> to parse the space-delimited VPC Flow Log format</li>
<li>Extracts 14 individual fields with appropriate data types</li>
<li>Removes the original <strong>message</strong> field after parsing <br>
<img alt="image.png" src="../../images/5/5.2/image%206.png"></li>
</ul>
</li>
<li>
<p>Test the Pipeline <br>
Before applying it to your data, test the pipeline with your sample data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">POST</span> <span style="color:#960050;background-color:#1e0010">_ingest/pipeline/vpc-flow-log-pipeline/_simulate</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;docs&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;_source&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;2 509069525939 eni-06dbfc5864eff22c5 10.0.2.79 10.0.2.216 443 56618 6 4 4734 1753442090 1753442117 ACCEPT OK&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The response should show your data parsed into individual fields: <br>
<img alt="image.png" src="../../images/5/5.2/image%207.png"></p>
</li>
<li>
<p>Apply Pipeline to New Data <br>
For <strong>new incoming data</strong>, create an index template that automatically applies the pipeline:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">PUT</span> <span style="color:#960050;background-color:#1e0010">_index_template/vpc-flow-logs-template</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;index_patterns&#34;</span>: [<span style="color:#e6db74">&#34;vpc-flow-logs-*&#34;</span>],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;template&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;settings&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;default_pipeline&#34;</span>: <span style="color:#e6db74">&#34;vpc-flow-log-pipeline&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;mappings&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;version&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;keyword&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;account_id&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;keyword&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;interface_id&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;keyword&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;srcaddr&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;ip&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;dstaddr&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;ip&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;srcport&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;integer&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;dstport&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;integer&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;protocol&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;integer&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;packets&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;integer&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;bytes&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;long&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;start&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;date&#34;</span>, <span style="color:#f92672">&#34;format&#34;</span>: <span style="color:#e6db74">&#34;epoch_second&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;end&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;date&#34;</span>, <span style="color:#f92672">&#34;format&#34;</span>: <span style="color:#e6db74">&#34;epoch_second&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;action&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;keyword&#34;</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;log_status&#34;</span>: { <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;keyword&#34;</span> }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img alt="image.png" src="../../images/5/5.2/image%208.png"></p>
</li>
</ol>
<ul>
<li>Keep this window open while you perform the following steps</li>
</ul>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/Network-Security-Monitoring-with-VPC-Flow-Logs/5-create-and-configure-opensearch-service/1-create-opensearch-service-domain/" title="Create OpenSearch Service Domain"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/Network-Security-Monitoring-with-VPC-Flow-Logs/6-create-kinesis-data-firehose/" title="Create Kinesis Data Firehose" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/clipboard.min.js?1754233304"></script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/perfect-scrollbar.min.js?1754233304"></script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/perfect-scrollbar.jquery.min.js?1754233304"></script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/jquery.sticky.js?1754233304"></script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/featherlight.min.js?1754233304"></script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/highlight.pack.js?1754233304"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/modernizr.custom-3.6.0.js?1754233304"></script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/learn.js?1754233304"></script>
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/js/hugo-learn.js?1754233304"></script>

    <link href="/Network-Security-Monitoring-with-VPC-Flow-Logs/mermaid/mermaid.css?1754233304" rel="stylesheet" />
    <script src="/Network-Security-Monitoring-with-VPC-Flow-Logs/mermaid/mermaid.js?1754233304"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
