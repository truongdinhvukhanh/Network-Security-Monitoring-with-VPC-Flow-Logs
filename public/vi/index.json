[
{
	"uri": "//localhost:1313/vi/",
	"title": "Giám sát an ninh mạng với VPC Flow Logs",
	"tags": [],
	"description": "",
	"content": "Giám sát an ninh mạng với VPC Flow Logs Tổng quan Trong bài lab này, bạn sẽ học cách xây dựng một giải pháp giám sát an ninh mạng toàn diện trên Amazon Web Services (AWS). Bạn sẽ triển khai một pipeline đầu cuối để thu thập, đưa vào, lưu trữ, phân tích và trực quan hóa VPC Flow Logs, giúp tăng cường khả năng hiển thị và bảo mật cho hạ tầng đám mây của bạn. Giải pháp này sẽ cung cấp cho bạn kinh nghiệm thực tế trong việc tận dụng các dịch vụ AWS chính để đạt được khả năng quan sát mạng mạnh mẽ.\nCác Module của bài lab Giới thiệu Các bước chuẩn bị Tạo EC2 Bastion Tạo S3 Bucket Tạo và cấu hình OpenSearch Service Tạo Kinesis Data Firehose Tạo VPC Flow Log Xác minh luồng dữ liệu và tạo Dashboard Truy vấn log với Athena Dọn dẹp tài nguyên Hãy đảm bảo bạn hoàn thành module \u0026ldquo;Dọn dẹp tài nguyên\u0026rdquo; sau khi kết thúc bài lab để tránh phát sinh bất kỳ chi phí không mong muốn nào trên tài khoản AWS của bạn. Các tài nguyên AWS tiếp tục phát sinh chi phí cho đến khi chúng được chấm dứt hoặc xóa bỏ đúng cách.\n"
},
{
	"uri": "//localhost:1313/vi/1-introduction/",
	"title": "Giới thiệu",
	"tags": [],
	"description": "",
	"content": "Tổng quan về Lab: Giám sát an ninh mạng với VPC Flow Logs Lab này sẽ hướng dẫn bạn xây dựng một giải pháp giám sát mạng toàn diện trên AWS bằng cách sử dụng VPC Flow Logs, Kinesis Data Firehose, Amazon OpenSearch Service và Amazon S3. Bạn sẽ học cách thu thập, đưa vào, lưu trữ, phân tích và trực quan hóa dữ liệu lưu lượng mạng từ Virtual Private Cloud (VPC) của bạn. Kiến trúc này cung cấp cái nhìn sâu sắc về bảo mật mạng, tình trạng hoạt động và cho phép khắc phục sự cố cũng như phát hiện mối đe dọa một cách chủ động.\nSơ đồ kiến trúc Sơ đồ trên minh họa kiến trúc chúng ta sẽ triển khai:\nTruy cập người dùng (1): Một quản trị viên kết nối an toàn với Bastion Host. Bastion Host (2): Một EC2 instance bảo mật trong public subnet hoạt động như một jump server để truy cập tài nguyên trong private subnet. VPC Flow Logs (3): Metadata lưu lượng mạng từ VPC được thu thập và gửi đến Kinesis Data Firehose. Amazon Kinesis Data Firehose (4): Một dịch vụ được quản lý hoàn toàn để thu thập và chuyển VPC Flow Logs đến cả Amazon OpenSearch Service và Amazon S3. Amazon OpenSearch Service (5): Xử lý và lập chỉ mục dữ liệu nhật ký luồng để phân tích và trực quan hóa theo thời gian thực thông qua OpenSearch Dashboards. Amazon S3 (6): Cung cấp lưu trữ bền vững và hiệu quả chi phí cho VPC Flow Logs thô, đóng vai trò sao lưu và là nguồn dữ liệu cho Amazon Athena. Amazon Athena (7): Một dịch vụ truy vấn tương tác cho phép bạn phân tích dữ liệu nhật ký luồng trực tiếp từ S3 bằng SQL tiêu chuẩn. Chi tiết Lab: Bạn sẽ làm gì? Workshop này được cấu trúc thành một số phần chính, mỗi phần tập trung vào một thành phần cụ thể của giải pháp:\nPhần 2: Chuẩn bị: Bạn sẽ thiết lập hạ tầng mạng AWS cơ bản, bao gồm tạo Virtual Private Cloud (VPC), định nghĩa public và private subnets, thiết lập Internet Gateway, cấu hình route tables và tạo các security groups cần thiết. Bạn cũng sẽ tạo các IAM policies và roles cần thiết để cấp quyền phù hợp cho các dịch vụ AWS.\nPhần 3: Tạo EC2 Bastion: Bạn sẽ khởi chạy và cấu hình một EC2 instance để đóng vai trò là Bastion Host. Host này sẽ cung cấp quyền truy cập SSH an toàn vào mạng riêng của bạn, cho phép bạn quản lý tài nguyên trong private subnets của mình.\nPhần 4: Tạo S3 Bucket: Bạn sẽ tạo một Amazon S3 bucket. Bucket này sẽ đóng vai trò là đích lưu trữ bền vững cho VPC Flow Logs thô của bạn, đảm bảo việc lưu giữ dữ liệu và cung cấp nguồn cho các phân tích sâu hơn.\nPhần 5: Tạo và cấu hình OpenSearch Service: Bạn sẽ triển khai một Amazon OpenSearch Service domain. Dịch vụ được quản lý này sẽ được cấu hình để đưa vào, lưu trữ và cho phép phân tích dữ liệu nhật ký luồng của bạn theo thời gian thực, cùng với việc thiết lập một ingest pipeline để phân tích cú pháp dữ liệu.\nPhần 6: Tạo Kinesis Data Firehose: Bạn sẽ thiết lập một Amazon Kinesis Data Firehose delivery stream. Stream này sẽ được cấu hình để tự động thu thập VPC Flow Logs và gửi chúng đến cả OpenSearch Service domain và S3 bucket của bạn.\nPhần 7: Tạo VPC Flow Log: Bạn sẽ bật và cấu hình VPC Flow Logs cho NSM-VPC của mình. Bước này đảm bảo rằng tất cả lưu lượng mạng trong VPC của bạn được thu thập và chuyển đến Kinesis Data Firehose stream để xử lý.\nPhần 8: Xác minh luồng dữ liệu và tạo Dashboard: Bạn sẽ xác minh rằng toàn bộ data pipeline đang hoạt động chính xác bằng cách kiểm tra việc đưa dữ liệu vào OpenSearch và sau đó tạo các dashboards đầy đủ thông tin trong OpenSearch Dashboards để trực quan hóa và phân tích VPC Flow Logs của bạn.\nPhần 9: Truy vấn nhật ký với Athena: Bạn sẽ học cách sử dụng Amazon Athena để truy vấn các VPC Flow Logs thô được lưu trữ trong S3 bucket của bạn, thực hiện phân tích ad-hoc bằng SQL tiêu chuẩn.\nPhần 10: Dọn dẹp tài nguyên: Cuối cùng, bạn sẽ làm theo các bước để loại bỏ có hệ thống tất cả các tài nguyên AWS đã được cung cấp trong buổi workshop này để tránh bất kỳ chi phí phát sinh nào.\nNội dung: Phần 2: Chuẩn bị Phần 3: Tạo EC2 Bastion Phần 4: Tạo S3 Bucket Phần 5: Tạo và cấu hình OpenSearch Service Phần 6: Tạo Kinesis Data Firehose Phần 7: Tạo VPC Flow Log Phần 8: Xác minh luồng dữ liệu và tạo Dashboard Phần 9: Truy vấn nhật ký với Athena Phần 10: Dọn dẹp tài nguyên "
},
{
	"uri": "//localhost:1313/vi/3-create-ec2-bastion/1-launch-an-ec2-instance-as-a-bastion-host/",
	"title": "Khởi chạy EC2 Instance làm Bastion Host",
	"tags": [],
	"description": "",
	"content": "\rTrong bước này, bạn sẽ khởi chạy một EC2 instance sẽ đóng vai trò là Bastion Host của bạn. Host này rất cần thiết để truy cập an toàn các EC2 instance và tài nguyên khác nằm trong private subnets trong VPC của bạn, những tài nguyên không có quyền truy cập internet trực tiếp. Việc thiết lập một Bastion Host giúp tập trung các điểm truy cập, tăng cường bảo mật bằng cách giảm bề mặt tấn công và cung cấp một điểm vào được kiểm soát cho các tác vụ quản trị trong mạng riêng của bạn.\nĐăng nhập vào AWS Management Console Trong thanh tìm kiếm, gõ EC2 Chọn EC2 từ danh sách dịch vụ Trong bảng điều khiển EC2: Nhấp vào Instances trong ngăn điều hướng Nhấp Launch instances Tên và Thẻ Name: Nhập NSM-Bastion-Host Chọn Amazon Machine Image (AMI): Dưới Quick Start, chọn Amazon Linux Chọn Amazon Linux 2023 từ các tùy chọn có sẵn Chọn thông số kỹ thuật instance: Chọn t2.micro Tạo Key Pair Nhấp Create new key pair Key pair name: NSM-Key Key pair type: Chọn RSA Private key file format: Chọn .pem Nhấp Create key pair Quan trọng: Tệp này sẽ chỉ được tải xuống một lần. Hãy lưu trữ nó an toàn Cấu hình Cài đặt Mạng Nhấp Edit trong phần Network settings VPC: Chọn NSM-VPC của bạn Subnet: Chọn NSM-Public-Subnet của bạn Auto-assign public IP: Bật Firewall (security groups): Chọn existing security group Chọn SG-Bastion từ danh sách thả xuống Xem lại và Khởi chạy Xem lại cài đặt của bạn Nhấp Launch instance Chờ Instance khởi tạo Nhấp View all instances Đợi cho đến khi Instance state hiển thị \u0026ldquo;Running\u0026rdquo; và Status checks hiển thị \u0026ldquo;2/2 checks passed\u0026rdquo; Lưu ý Public IPv4 address của instance của bạn "
},
{
	"uri": "//localhost:1313/vi/5-create-and-configure-opensearch-service/1-create-opensearch-service-domain/",
	"title": "Tạo OpenSearch Service Domain",
	"tags": [],
	"description": "",
	"content": "\rTrong bước này, bạn sẽ tạo Amazon OpenSearch Service domain của mình. Domain này sẽ hoạt động như nền tảng phân tích và tìm kiếm nhật ký tập trung cho dữ liệu VPC Flow Logs được thu thập trong lab này. Bạn sẽ cấu hình loại instance, bộ nhớ và quan trọng nhất là tích hợp nó vào private subnet của NSM-VPC, đảm bảo quyền truy cập an toàn chỉ từ bên trong mạng đã xác định của bạn, từ đó tăng cường cách ly và bảo mật dữ liệu.\nĐăng nhập vào AWS Management Console Trong thanh tìm kiếm, gõ Amazon OpenSearch Service Chọn Amazon OpenSearch Service từ danh sách dịch vụ Nhấp Create domain để bắt đầu Cấu hình Domain Domain name: Nhập nsm-opensearch Domain creation method: Chọn Standard create Templates: Chọn Dev/test (cho môi trường lab) Deployment option(s): Chọn Domain without standby (đủ cho mục đích lab) Availability Zone(s): Chọn 1-AZ Version: Chọn phiên bản OpenSearch mới nhất có sẵn (ví dụ: OpenSearch 2.19) Số lượng data nodes Instance family: Chọn General purpose từ danh sách thả xuống Instance type: Chọn t3.small.search (đủ cho mục đích lab) Number of data nodes: Đặt thành 1 (cho môi trường lab) Storage type: Chọn EBS Volume type: General Purpose (SSD) - gp3 Storage size per node: 10 GiB Cấu hình Mạng Network: Chọn VPC access IP address type: Chọn IPv4 only VPC: Chọn NSM-VPC của bạn từ danh sách thả xuống Subnets: Chọn NSM-Private-Subnet Security groups: Chọn SG-OpenSearch Kiểm soát truy cập chi tiết Bỏ chọn Enable fine-grained access control Chính sách truy cập: Chọn Configure domain level access policy Action: Chọn Allow Xem lại và Tạo Xem lại tất cả các cài đặt để đảm bảo chúng khớp với yêu cầu của bạn Nhấp Create để bắt đầu tạo domain Chờ cho trạng thái domain thay đổi thành Active (quá trình này có thể mất 15-20 phút) Sao chép OpenSearch Dashboards URL (không bao gồm https:// và /_dashboards) "
},
{
	"uri": "//localhost:1313/vi/2-preparation/1-create-vpc/",
	"title": "Tạo VPC",
	"tags": [],
	"description": "",
	"content": "\rTạo một Amazon Virtual Private Cloud (VPC) là bước nền tảng cho lab này. Nó cung cấp một mạng ảo được cách ly logic mà bạn định nghĩa, đóng vai trò là môi trường an toàn và riêng tư nơi tất cả tài nguyên AWS của dự án (chẳng hạn như subnets, instances và services) sẽ cư trú. Sự cách ly này đảm bảo rằng các tài nguyên của bạn nằm trong tầm kiểm soát và không bị lộ ra internet công cộng trừ khi được cấu hình rõ ràng.\nHướng dẫn từng bước tạo VPC Điều hướng đến AWS Management Console Trong thanh tìm kiếm, tìm và chọn VPC Bắt đầu tạo VPC: Chọn Your VPCs từ bảng điều hướng bên trái Nhấp vào nút Create VPC ở góc trên bên phải Cấu hình cài đặt VPC của bạn: Dưới Resources to create, chọn VPC only Nhập Name tag: NSM-VPC Đặt IPv4 CIDR block: 10.0.0.0/16 Hoàn tất việc tạo VPC: Xem lại cài đặt của bạn Nhấp Create VPC Xác minh việc tạo VPC thành công: Bạn sẽ thấy một thông báo thành công VPC mới của bạn sẽ xuất hiện trong danh sách VPC "
},
{
	"uri": "//localhost:1313/vi/8-verify-data-flow-and-create-dashboard/1-verify-data-flow/",
	"title": "Xác minh luồng dữ liệu",
	"tags": [],
	"description": "",
	"content": "\rTrong bước này, bạn sẽ xác minh rằng VPC Flow Logs đang được thu thập và gửi thành công đến Amazon OpenSearch Service thông qua Kinesis Data Firehose. Việc kiểm tra luồng dữ liệu này là rất cần thiết để đảm bảo toàn bộ đường ống giám sát mạng của bạn đang hoạt động như mong đợi, cung cấp dữ liệu mạng theo thời gian thực để phân tích và trực quan hóa sau này.\nXác minh việc nhập dữ liệu vào OpenSearch Dashboards Tạo lưu lượng mạng để kiểm tra Trước khi xác minh luồng dữ liệu, hãy đảm bảo bạn có một số lưu lượng mạng để phân tích:\nSSH vào Bastion Host của bạn bằng cặp khóa của bạn Từ Bastion Host, hãy thử kết nối với các tài nguyên khác trong VPC của bạn Chạy một số lệnh mạng cơ bản như ping, curl hoặc wget Chờ khoảng 5 - 10 phút Xác minh việc gửi qua Kinesis Data Firehose\nĐiều hướng đến Amazon Kinesis console Chọn luồng NSM-FlowLogs-Firehose của bạn Nhấp vào tab Monitoring Tìm kiếm: Incoming records (phải lớn hơn 0) Incoming bytes (phải lớn hơn 0) S3 delivery success (phải khớp với số bản ghi đến) OpenSearch delivery success (phải khớp với số bản ghi đến) Kiểm tra lỗi\nTìm kiếm bất kỳ nhật ký lỗi nào: Destination error logs Backup error logs Nếu bạn thấy lỗi, hãy kiểm tra nhật ký CloudWatch cho luồng Firehose của bạn Xác minh việc gửi đến S3 Bucket\nĐiều hướng đến the AWS S3 Console Nhấp vào tên S3 bucket của bạn Điều hướng qua cấu trúc tiền tố bạn đã cấu hình (ví dụ: flow-logs/year=2025/month=07/day=22/hour=17/) Bạn sẽ thấy các tệp có dấu thời gian tương ứng với thời điểm nhật ký luồng của bạn được tạo Xác minh việc gửi đến OpenSearch Service\nQuay lại: https://localhost:9200/_dashboards/ Trong Dev Tools Chạy lệnh sau để liệt kê tất cả các chỉ mục: GET _cat/indices?v Tìm kiếm các chỉ mục khớp với mẫu chỉ mục bạn đã cấu hình (ví dụ: vpc-flow-logs) Xác minh rằng chỉ mục có các tài liệu (cột docs.count phải lớn hơn 0) "
},
{
	"uri": "//localhost:1313/vi/2-preparation/",
	"title": "Chuẩn bị",
	"tags": [],
	"description": "",
	"content": "Tổng quan về các bước chuẩn bị Trong phần này, chúng ta sẽ thiết lập hạ tầng AWS nền tảng cần thiết cho workshop của mình. Điều này bao gồm việc thiết lập Virtual Private Cloud (VPC) với các subnets, cấu hình kết nối internet bằng Internet Gateway và Route Tables, định nghĩa bảo mật mạng bằng Security Groups, và tạo các IAM policies và IAM roles cần thiết cho quyền của dịch vụ. Các bước này rất quan trọng để xây dựng một môi trường an toàn, có khả năng mở rộng và chức năng cho các tài nguyên AWS của bạn.\nCác khái niệm chính: Virtual Private Cloud (VPC): Một mạng ảo được cách ly logic trong AWS nơi bạn có thể khởi chạy các tài nguyên AWS. Subnets: Các phân đoạn của dải địa chỉ IP của VPC nơi bạn có thể đặt các nhóm tài nguyên được cách ly, được phân loại là public (có thể truy cập internet) hoặc private (chỉ nội bộ). Internet Gateway (IGW): Một thành phần của VPC cho phép giao tiếp giữa VPC của bạn và internet. Route Table: Một tập hợp các quy tắc xác định nơi lưu lượng mạng từ subnet hoặc gateway của bạn được định tuyến. Security Groups: Các tường lửa ảo cho các Amazon EC2 instances của bạn, kiểm soát lưu lượng vào và ra dựa trên các quy tắc. IAM Policy: Một tài liệu định nghĩa quyền hạn, chỉ rõ ai có thể truy cập tài nguyên AWS nào và trong điều kiện nào. IAM Role: Một danh tính AWS với các chính sách quyền hạn xác định những gì danh tính đó có thể và không thể làm trong AWS. Các Role được đảm nhiệm bởi các thực thể đáng tin cậy. Nội dung: 2.1 Tạo VPC 2.2 Tạo Subnets 2.3 Tạo Internet Gateway 2.4 Tạo Route Table 2.5 Tạo Security Groups 2.6 Tạo IAM Policy và IAM Role "
},
{
	"uri": "//localhost:1313/vi/3-create-ec2-bastion/2-connect-to-the-bastion-host-via-ssh/",
	"title": "Kết nối với Bastion Host qua SSH",
	"tags": [],
	"description": "",
	"content": "\rBước này hướng dẫn cách kết nối an toàn đến host NSM-Bastion của bạn bằng SSH. Thiết lập kết nối SSH tới Bastion Host là rất quan trọng vì nó hoạt động như một máy chủ trung gian bảo mật, cho phép bạn truy cập các tài nguyên khác trong private subnets (vốn không thể truy cập trực tiếp từ internet). Điều này đảm bảo rằng hạ tầng nội bộ của bạn vẫn được cô lập và bảo vệ, với tất cả các điểm truy cập được kiểm soát chặt chẽ thông qua Bastion Host.\nMở Command Prompt với quyền Quản trị viên Xóa tất cả các quyền truy cập hiện tại vào tệp: icacls \u0026#34;\u0026lt;your-path-to-keypairfile\u0026gt;\u0026#34; /inheritance:r icacls \u0026#34;\u0026lt;your-path-to-keypairfile\u0026gt;\u0026#34; /remove:g *S-1-1-0 Thay thế \u0026lt;your-path-to-keypairfile\u0026gt; bằng đường dẫn thực tế đến tệp NSM-Key.pem của bạn /inheritance:r: Vô hiệu hóa việc kế thừa quyền từ thư mục cha /remove:g *S-1-1-0: Xóa quyền cho nhóm \u0026ldquo;Everyone\u0026rdquo; Cấp quyền Đọc \u0026amp; Thực thi cho người dùng hiện tại: icacls \u0026#34;\u0026lt;your-path-to-keypairfile\u0026gt;\u0026#34; /grant:r \u0026lt;YourName\u0026gt;:(RX) Thay thế \u0026lt;YourName\u0026gt; bằng tên người dùng Windows thực tế của bạn (RX): Viết tắt của Read \u0026amp; Execute (Đọc \u0026amp; Thực thi) Nếu bạn không chắc chắn về tên người dùng của mình, bạn có thể chạy lệnh whoami để tìm. Ví dụ, nếu kết quả là users/aws, hãy thay thế \u0026lt;YourName\u0026gt; bằng aws Kiểm tra các quyền đã gán: icacls \u0026#34;\u0026lt;your-path-to-keypairfile\u0026gt;\u0026#34; Kết nối với Bastion Host qua SSH: ssh -i \u0026#34;\u0026lt;your-path-to-keypairfile\u0026gt;\u0026#34; ec2-user@\u0026lt;Public-IP\u0026gt; Thay thế \u0026lt;your-path-to-keypairfile\u0026gt; bằng đường dẫn đến tệp NSM-Key.pem của bạn. Thay thế \u0026lt;Public-IP\u0026gt; bằng địa chỉ IP công cộng của EC2 instance của bạn. Nhắc nhở kết nối lần đầu: Lần đầu tiên bạn kết nối, bạn sẽ được hỏi \u0026ldquo;Are you sure you want to continue connecting (yes/no/[fingerprint])?\u0026rdquo;. Gõ yes Bạn đã hoàn thành thành công việc tạo và xác minh Bastion EC2. "
},
{
	"uri": "//localhost:1313/vi/8-verify-data-flow-and-create-dashboard/2-create-dashboard/",
	"title": "Tạo Dashboard",
	"tags": [],
	"description": "",
	"content": "\rTrong bước này, bạn sẽ tạo một bảng điều khiển trong OpenSearch Dashboards để trực quan hóa dữ liệu VPC Flow Logs của mình. Xây dựng một bảng điều khiển giúp bạn dễ dàng giám sát và phân tích các mẫu lưu lượng mạng, xác định các bất thường và có được những hiểu biết sâu sắc hơn về hoạt động mạng của VPC thông qua các biểu đồ và số liệu thống kê trực quan.\nTạo Trực quan hóa và Dashboard Tạo Mẫu chỉ mục mới Trong thanh bên trái, nhấp vào Dashboards Management Nhấp vào Index patterns Nhấp Create index pattern Index pattern name: Nhập vpc-flow-logs* Nhấp Next step Time field: Chọn start Nhấp Create index pattern Tạo Biểu đồ tròn cho Lưu lượng truy cập theo IP nguồn Trong thanh bên trái, nhấp vào Visualize Nhấp Create visualization Chọn Pie làm loại trực quan hóa Chọn mẫu chỉ mục của bạn Dưới Buckets, nhấp Add → Split slices Aggregation: Chọn Terms Field: Chọn srcaddr (địa chỉ IP nguồn) Size: 10 Nhấp Update để xem trực quan hóa Nhấp Save và đặt tên là Top Source IPs Tạo Biểu đồ cột cho Lưu lượng truy cập theo Cổng đích Quay lại Visualizations List Nhấp Create visualization Chọn Vertical bar làm loại trực quan hóa Chọn mẫu chỉ mục của bạn Dưới Buckets, nhấp Add → X-axis Aggregation: Chọn Terms Field: Chọn dstport (cổng đích) Size: 10 (top 10 cổng đích) Nhấp Update để xem trực quan hóa Nhấp Save và đặt tên là Top Destination Ports Tạo Biểu đồ đường cho Lưu lượng truy cập theo thời gian Quay lại Visualizations List Nhấp Create visualization Chọn Line làm loại trực quan hóa Chọn mẫu chỉ mục của bạn Dưới Buckets, nhấp Add → X-axis Aggregation: Chọn Date Histogram Field: Chọn start Interval: Chọn Auto Nhấp Update để xem trực quan hóa Nhấp Save và đặt tên là Traffic Over Time Tạo Dashboard mới Trong thanh bên trái, nhấp vào Dashboard Nhấp Create new dashboard Nhấp Add ở góc trên bên phải Chọn tất cả các trực quan hóa bạn đã tạo: Top Source IPs Top Destination Ports Traffic Over Time Sắp xếp các trực quan hóa bằng cách kéo và thay đổi kích thước chúng Nhấp Save ở góc trên bên phải Đặt tên là VPC Flow Logs Dashboard "
},
{
	"uri": "//localhost:1313/vi/5-create-and-configure-opensearch-service/2-create-ingest-pipeline/",
	"title": "Tạo Ingest Pipeline",
	"tags": [],
	"description": "",
	"content": "\rBước này rất quan trọng để chuẩn bị OpenSearch domain của bạn để đưa vào và phân tích dữ liệu VPC Flow Log một cách chính xác. Bạn sẽ xác minh quyền truy cập vào OpenSearch Dashboards thông qua một đường hầm SSH qua Bastion Host của bạn. Sau đó, bạn sẽ tạo và kiểm tra một ingest pipeline (vpc-flow-log-pipeline). Pipeline này sử dụng một bộ xử lý Grok để phân tích cú pháp các thông báo VPC Flow Log thô, không có cấu trúc thành các trường riêng biệt, có thể tìm kiếm được, làm cho dữ liệu trở nên rất có giá trị cho phân tích bảo mật và giám sát mạng trong OpenSearch.\nXác minh quyền truy cập vào OpenSearch Dashboards Bây giờ OpenSearch domain của bạn đã hoạt động, bạn cần xác minh rằng bạn có thể truy cập OpenSearch Dashboards.\nThiết lập Đường hầm SSH để truy cập OpenSearch Dashboards\nMở một terminal hoặc command prompt trên máy tính cục bộ của bạn Tạo một đường hầm SSH qua Bastion Host của bạn ssh -i \u0026#34;your-key.pem\u0026#34; -L 9200:your-opensearch-endpoint:443 ec2-user@your-bastion-host-ip Thay thế your-key.pem bằng đường dẫn đến tệp khóa của bạn Thay thế your-opensearch-endpoint bằng endpoint OpenSearch domain của bạn (không bao gồm https:// và /_dashboards) mà bạn đã sao chép ở bước trước Thay thế your-bastion-host-ip bằng IP công cộng của Bastion Host của bạn Giữ cửa sổ terminal này mở trong khi bạn thực hiện các bước sau Truy cập OpenSearch Dashboards\nMở trình duyệt web của bạn, nhập URL: https://localhost:9200/_dashboards/ Xác minh quyền truy cập quản trị của bạn\nKhám phá giao diện OpenSearch Dashboards Sau khi đăng nhập, bạn sẽ thấy trang chủ OpenSearch Dashboards Dành chút thời gian để làm quen với giao diện Kiểm tra tình trạng Cluster Trong menu điều hướng bên trái, nhấp vào Dev Tools Trong Console, chạy lệnh sau: GET _cluster/health Phản hồi sẽ hiển thị trạng thái sức khỏe của cluster của bạn (lý tưởng là \u0026ldquo;green\u0026rdquo;) Tạo Ingest Pipeline Thực hiện lệnh này trong console Dev Tools để tạo pipeline phân tích cú pháp của bạn:\nPUT _ingest/pipeline/vpc-flow-log-pipeline { \u0026#34;description\u0026#34;: \u0026#34;Pipeline to parse VPC Flow Log data\u0026#34;, \u0026#34;processors\u0026#34;: [ { \u0026#34;grok\u0026#34;: { \u0026#34;field\u0026#34;: \u0026#34;message\u0026#34;, \u0026#34;patterns\u0026#34;: [ \u0026#34;%{NUMBER:version:int} %{NUMBER:account_id} (%{NOTSPACE:interface_id}|-) (%{IP:srcaddr}|-) (%{IP:dstaddr}|-) (%{NUMBER:srcport:int}|-) (%{NUMBER:dstport:int}|-) (%{NUMBER:protocol:int}|-) (%{NUMBER:packets:int}|-) (%{NUMBER:bytes:long}|-) (%{NUMBER:start:long}|-) (%{NUMBER:end:long}|-) (%{WORD:action}|-) (%{WORD:log_status}|-)\u0026#34; ] } }, { \u0026#34;script\u0026#34;: { \u0026#34;description\u0026#34;: \u0026#34;Convert dash values to null\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;\u0026#34;\u0026#34; def fields = [\u0026#39;interface_id\u0026#39;, \u0026#39;srcaddr\u0026#39;, \u0026#39;dstaddr\u0026#39;, \u0026#39;srcport\u0026#39;, \u0026#39;dstport\u0026#39;, \u0026#39;protocol\u0026#39;, \u0026#39;packets\u0026#39;, \u0026#39;bytes\u0026#39;, \u0026#39;start\u0026#39;, \u0026#39;end\u0026#39;, \u0026#39;action\u0026#39;, \u0026#39;log_status\u0026#39;]; for (def field : fields) { if (ctx.containsKey(field) \u0026amp;\u0026amp; ctx[field] == \u0026#39;-\u0026#39;) { ctx[field] = null; } } \u0026#34;\u0026#34;\u0026#34; } }, { \u0026#34;remove\u0026#34;: { \u0026#34;field\u0026#34;: \u0026#34;message\u0026#34; } } ] } Pipeline này:\nSử dụng một Grok processor để phân tích cú pháp định dạng VPC Flow Log được phân tách bằng dấu cách Trích xuất 14 trường riêng lẻ với các kiểu dữ liệu phù hợp Xóa trường message gốc sau khi phân tích cú pháp Kiểm tra Pipeline Trước khi áp dụng nó cho dữ liệu của bạn, hãy kiểm tra pipeline với dữ liệu mẫu của bạn:\nPOST _ingest/pipeline/vpc-flow-log-pipeline/_simulate { \u0026#34;docs\u0026#34;: [ { \u0026#34;_source\u0026#34;: { \u0026#34;message\u0026#34;: \u0026#34;2 509069525939 eni-06dbfc5864eff22c5 10.0.2.79 10.0.2.216 443 56618 6 4 4734 1753442090 1753442117 ACCEPT OK\u0026#34; } } ] } Phản hồi sẽ hiển thị dữ liệu của bạn được phân tích thành các trường riêng lẻ: Áp dụng Pipeline cho Dữ liệu mới Đối với dữ liệu mới đến, hãy tạo một index template tự động áp dụng pipeline:\nPUT _index_template/vpc-flow-logs-template { \u0026#34;index_patterns\u0026#34;: [\u0026#34;vpc-flow-logs-*\u0026#34;], \u0026#34;template\u0026#34;: { \u0026#34;settings\u0026#34;: { \u0026#34;default_pipeline\u0026#34;: \u0026#34;vpc-flow-log-pipeline\u0026#34; }, \u0026#34;mappings\u0026#34;: { \u0026#34;properties\u0026#34;: { \u0026#34;version\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;keyword\u0026#34; }, \u0026#34;account_id\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;keyword\u0026#34; }, \u0026#34;interface_id\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;keyword\u0026#34; }, \u0026#34;srcaddr\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;ip\u0026#34; }, \u0026#34;dstaddr\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;ip\u0026#34; }, \u0026#34;srcport\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;integer\u0026#34; }, \u0026#34;dstport\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;integer\u0026#34; }, \u0026#34;protocol\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;integer\u0026#34; }, \u0026#34;packets\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;integer\u0026#34; }, \u0026#34;bytes\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;long\u0026#34; }, \u0026#34;start\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;date\u0026#34;, \u0026#34;format\u0026#34;: \u0026#34;epoch_second\u0026#34; }, \u0026#34;end\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;date\u0026#34;, \u0026#34;format\u0026#34;: \u0026#34;epoch_second\u0026#34; }, \u0026#34;action\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;keyword\u0026#34; }, \u0026#34;log_status\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;keyword\u0026#34; } } } } } Giữ cửa sổ này mở trong khi bạn thực hiện các bước tiếp theo "
},
{
	"uri": "//localhost:1313/vi/2-preparation/2-create-subnets/",
	"title": "Tạo Subnets",
	"tags": [],
	"description": "",
	"content": "\rTrong lab này, việc tạo public và private subnets trong VPC của bạn là rất cần thiết để phân đoạn mạng. Public subnet sẽ chứa các tài nguyên như Bastion Host yêu cầu truy cập internet, trong khi private subnet sẽ lưu trữ an toàn các tài nguyên nội bộ như OpenSearch domain của bạn, đảm bảo chúng không bị lộ trực tiếp ra internet. Thiết lập này giúp tăng cường bảo mật và tổ chức mạng của bạn cho kiến trúc đã lên kế hoạch.\nTạo Public Subnet Truy cập giao diện tạo subnet: Điều hướng đến bảng điều khiển VPC Chọn Subnets từ bảng điều hướng bên trái Nhấp Create subnet Chọn VPC của bạn: Trong giao diện Create subnet, chọn NSM-VPC từ danh sách thả xuống Cấu hình public subnet của bạn: Subnet name: Nhập NSM-Public-Subnet Availability Zone: Chọn us-east-1a IPv4 CIDR block: Nhập 10.0.1.0/24 Nhấp Create subnet Xác minh việc tạo subnet thành công: Bạn sẽ thấy một thông báo thành công Subnet mới của bạn sẽ xuất hiện trong danh sách subnet Bật tự động gán IP công cộng cho public subnet Chọn NSM-Public-Subnet từ danh sách subnet Nhấp Actions \u0026gt; Edit subnet settings Cấu hình cài đặt tự động gán IP: Dưới Auto-assign IP settings, chọn Enable auto-assign public IPv4 address Nhấp Save Tạo Private Subnet Nhấp Create subnet Nhập các chi tiết sau: VPC ID: Chọn NSM-VPC từ danh sách thả xuống Subnet name: Nhập NSM-Private-Subnet Availability Zone: Chọn us-east-1a IPv4 CIDR block: Nhập 10.0.2.0/24 Nhấp Create subnet "
},
{
	"uri": "//localhost:1313/vi/3-create-ec2-bastion/",
	"title": "Tạo EC2 Bastion",
	"tags": [],
	"description": "",
	"content": "Tổng quan về Thiết lập EC2 Bastion Host Trong phần này, chúng ta sẽ thiết lập và kết nối với một EC2 Bastion Host. Một Bastion Host hoạt động như một máy chủ trung gian bảo mật, cung cấp quyền truy cập được kiểm soát vào các tài nguyên mạng riêng của bạn từ một mạng bên ngoài (như internet). Đây là một thành phần quan trọng để quản lý an toàn các instance nằm trong private subnets, đảm bảo rằng việc truy cập SSH trực tiếp vào các máy chủ nội bộ được giảm thiểu, từ đó nâng cao tổng thể bảo mật đám mây của bạn.\nCác khái niệm chính: EC2 Instance: Một máy chủ ảo trong Amazon Elastic Compute Cloud (EC2) để chạy các ứng dụng. Bastion Host: Một máy chủ hoạt động như một cổng bảo mật đến một mạng riêng, cho phép truy cập có kiểm soát vào các tài nguyên nội bộ. Key Pair: Một bộ thông tin xác thực bảo mật (khóa công khai và khóa riêng tư) được sử dụng để chứng minh danh tính của bạn khi kết nối với các EC2 instance. SSH (Secure Shell): Một giao thức mạng mã hóa để giao tiếp dữ liệu an toàn, đăng nhập dòng lệnh từ xa và các dịch vụ mạng an toàn khác. Mục lục: 3.1 Khởi chạy EC2 Instance làm Bastion Host 3.2 Kết nối với Bastion Host qua SSH "
},
{
	"uri": "//localhost:1313/vi/2-preparation/3-create-internet-gateway/",
	"title": "Tạo Internet Gateway",
	"tags": [],
	"description": "",
	"content": "\rMột Internet Gateway (IGW) rất quan trọng đối với lab này vì nó cho phép public subnet trong NSM-VPC của bạn giao tiếp với internet. Đây là điều kiện tiên quyết để các tài nguyên như Bastion Host trong public subnet có thể truy cập được để quản lý và để bất kỳ dịch vụ công cộng nào hoạt động như dự kiến.\nHướng dẫn từng bước tạo Internet Gateway Truy cập giao diện Internet Gateway: Điều hướng đến bảng điều khiển VPC Chọn Internet Gateways từ bảng điều hướng bên trái Nhấp Create internet gateway Cấu hình Internet Gateway của bạn: Nhập Name tag: NSM-IGW Nhấp Create internet gateway Xác minh việc tạo Internet Gateway thành công: Bạn sẽ thấy một thông báo thành công Internet Gateway mới của bạn sẽ xuất hiện trong danh sách Gắn Internet Gateway vào VPC của bạn: Chọn Internet Gateway mới tạo của bạn Nhấp vào danh sách thả xuống Actions Chọn Attach to VPC Chọn NSM-VPC từ danh sách thả xuống Nhấp Attach internet gateway Xác nhận gắn thành công: State của Internet Gateway của bạn sẽ chuyển thành Attached Điều này cho thấy Internet Gateway hiện đang hoạt động với VPC của bạn "
},
{
	"uri": "//localhost:1313/vi/2-preparation/4-create-route-table/",
	"title": "Tạo Route Table",
	"tags": [],
	"description": "",
	"content": "\rTrong lab này, việc cấu hình một Route Table là rất quan trọng để định tuyến lưu lượng đến và từ các subnets của bạn. Cụ thể, chúng ta sẽ tạo một route table định tuyến tất cả lưu lượng truy cập internet từ NSM-Public-Subnet của bạn thông qua NSM-IGW mà bạn vừa tạo. Điều này đảm bảo rằng các tài nguyên trong public subnet có thể gửi và nhận dữ liệu từ internet, điều cần thiết cho chức năng dự kiến của chúng.\nHướng dẫn từng bước tạo Route Table Truy cập giao diện Route Table: Điều hướng đến bảng điều khiển VPC Chọn Route Tables từ bảng điều hướng bên trái Nhấp Create route table Cấu hình Route Table của bạn: Nhập Name: NSM-Public-RT Chọn VPC: Chọn NSM-VPC từ danh sách thả xuống Nhấp Create route table Xác minh việc tạo Route Table thành công: Bạn sẽ thấy một thông báo thành công Route Table mới của bạn sẽ xuất hiện trong danh sách Sửa đổi các tuyến đường trong Route Table của bạn: Chọn Route Table mới tạo của bạn Nhấp vào danh sách thả xuống Actions Chọn Edit routes Thêm một tuyến đường Internet: Nhấp Add route Đối với Destination, nhập 0.0.0.0/0 (đại diện cho tất cả lưu lượng IPv4) Đối với Target, chọn Internet Gateway và chọn NSM-IGW Nhấp Save changes Liên kết Route Table với public subnet của bạn: Chọn tab Subnet associations Nhấp Edit subnet associations Chọn các subnets phù hợp: Chọn NSM-Public-Subnet bạn đã tạo trước đó Nhấp Save associations Xác nhận các liên kết subnet của bạn: Xem lại các subnets liên kết trong tab Subnet associations Public subnet hiện đã được cấu hình để định tuyến lưu lượng internet thông qua Internet Gateway "
},
{
	"uri": "//localhost:1313/vi/4-create-s3-bucket/",
	"title": "Tạo S3 Bucket",
	"tags": [],
	"description": "",
	"content": "\rTrong phần này, bạn sẽ tạo một Amazon S3 (Simple Storage Service) bucket. S3 bucket này là một thành phần quan trọng trong kiến trúc dự án của chúng ta vì nó sẽ đóng vai trò là đích lưu trữ chính cho dữ liệu được xử lý bởi Kinesis Firehose. S3 cung cấp khả năng lưu trữ đối tượng có độ bền cao, khả năng mở rộng và bảo mật, khiến nó trở thành lựa chọn lý tưởng để lưu trữ dữ liệu thô hoặc đã xử lý một cách đáng tin cậy trước khi phân tích thêm hoặc lưu trữ dài hạn.\nTạo S3 Bucket Đăng nhập vào AWS Management Console Trong thanh tìm kiếm, gõ S3 Chọn S3 từ danh sách dịch vụ Trong giao diện S3, chọn Create bucket Trong giao diện Create bucket Bucket type: Chọn General purpose Bucket name: Gõ nsm-flow-logs-YYYYMMDD (thay thế YYYYMMDD bằng ngày hôm nay để đảm bảo tính duy nhất) Nhấp Create bucket Tạo Cấu trúc Thư mục để Lưu trữ Dữ liệu có Tổ chức Chọn bucket mới tạo của bạn Cuộn xuống và nhấp Create folder Tạo các thư mục sau: flow-logs (cho dữ liệu VPC Flow Logs) athena-results (để lưu trữ kết quả truy vấn Athena) Xác minh hai thư mục đã được tạo thành công Cấu hình Bucket Policy cho Firehose Access Chuyển đến tab Permissions Cuộn xuống Bucket policy và nhấp Edit Sao chép và dán policy sau, thay thế các phần giữ chỗ: { \u0026#34;Version\u0026#34;: \u0026#34;2012-10-17\u0026#34;, \u0026#34;Statement\u0026#34;: [ { \u0026#34;Sid\u0026#34;: \u0026#34;AllowFirehoseDelivery\u0026#34;, \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Principal\u0026#34;: { \u0026#34;Service\u0026#34;: \u0026#34;firehose.amazonaws.com\u0026#34; }, \u0026#34;Action\u0026#34;: [ \u0026#34;s3:AbortMultipartUpload\u0026#34;, \u0026#34;s3:GetBucketLocation\u0026#34;, \u0026#34;s3:GetObject\u0026#34;, \u0026#34;s3:ListBucket\u0026#34;, \u0026#34;s3:ListBucketMultipartUploads\u0026#34;, \u0026#34;s3:PutObject\u0026#34; ], \u0026#34;Resource\u0026#34;: [ \u0026#34;arn:aws:s3:::nsm-flow-logs-YYYYMMDD\u0026#34;, \u0026#34;arn:aws:s3:::nsm-flow-logs-YYYYMMDD/*\u0026#34; ], \u0026#34;Condition\u0026#34;: { \u0026#34;StringEquals\u0026#34;: { \u0026#34;aws:SourceAccount\u0026#34;: \u0026#34;YOUR-ACCOUNT-ID\u0026#34; }, \u0026#34;ArnLike\u0026#34;: { \u0026#34;aws:SourceArn\u0026#34;: \u0026#34;arn:aws:firehose:us-east-1:YOUR-ACCOUNT-ID:deliverystream/*\u0026#34; } } }, { \u0026#34;Sid\u0026#34;: \u0026#34;AllowAthenaAccess\u0026#34;, \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Principal\u0026#34;: { \u0026#34;Service\u0026#34;: \u0026#34;athena.amazonaws.com\u0026#34; }, \u0026#34;Action\u0026#34;: [ \u0026#34;s3:GetBucketLocation\u0026#34;, \u0026#34;s3:GetObject\u0026#34;, \u0026#34;s3:ListBucket\u0026#34;, \u0026#34;s3:ListBucketMultipartUploads\u0026#34;, \u0026#34;s3:ListMultipartUploadParts\u0026#34;, \u0026#34;s3:AbortMultipartUpload\u0026#34;, \u0026#34;s3:PutObject\u0026#34; ], \u0026#34;Resource\u0026#34;: [ \u0026#34;arn:aws:s3:::nsm-flow-logs-YYYYMMDD\u0026#34;, \u0026#34;arn:aws:s3:::nsm-flow-logs-YYYYMMDD/*\u0026#34; ] } ] } Thay thế: nsm-flow-logs-YYYYMMDD bằng tên bucket thực tế của bạn (4 vị trí) YOUR-ACCOUNT-ID bằng ID tài khoản AWS của bạn (tìm thấy ở góc trên bên phải của AWS console) Đảm bảo khu vực phù hợp với thiết lập của bạn (us-east-1 trong ví dụ này) Nhấp Save changes "
},
{
	"uri": "//localhost:1313/vi/2-preparation/5-create-security-groups/",
	"title": "Tạo Security Groups",
	"tags": [],
	"description": "",
	"content": "\rSecurity Groups là nền tảng để định nghĩa kiểm soát truy cập mạng cho các thành phần khác nhau trong lab này. Bằng cách tạo SG-Bastion, SG-Firehose, và SG-OpenSearch, chúng ta thiết lập quyền kiểm soát chi tiết đối với lưu lượng truy cập được phép đến các instances và services của bạn. Điều này đảm bảo rằng chỉ những truy cập được ủy quyền (ví dụ: SSH đến Bastion, Firehose đến OpenSearch) mới được phép, từ đó nâng cao tổng thể bảo mật của giải pháp đã triển khai của bạn.\nSecurity Group cho Bastion Truy cập giao diện Security Group: Điều hướng đến bảng điều khiển VPC Chọn Security Groups từ bảng điều hướng bên trái Nhấp Create security group Cấu hình Security Group cho Bastion: Security group name: Nhập SG-Bastion Description: Nhập Security group for Bastion Host access VPC: Chọn NSM-VPC từ danh sách thả xuống Định nghĩa các quy tắc Inbound: Nhấp Add rule Cấu hình quyền truy cập SSH: Type: Chọn SSH Source: Chọn My IP (tự động sử dụng địa chỉ IPv4 công cộng hiện tại của bạn) Xem lại các quy tắc Outbound: Theo mặc định, tất cả lưu lượng outbound đều được cho phép Nhấp Create security group Xác minh việc tạo thành công: Bạn sẽ thấy một thông báo thành công Security group mới của bạn sẽ xuất hiện trong danh sách Security Group cho Firehose Bắt đầu tạo một security group khác: Điều hướng trở lại Security Groups Nhấp Create security group Cấu hình Security Group cho Firehose: Security group name: Nhập SG-Firehose Description: Nhập Security group for Firehose VPC: Chọn NSM-VPC từ danh sách thả xuống Hoàn tất việc tạo security group: Xem lại cài đặt của bạn Nhấp Create security group Xác minh việc tạo thành công: Bạn sẽ thấy một thông báo thành công Security group mới của bạn sẽ xuất hiện trong danh sách Security Group cho OpenSearch Bắt đầu tạo một security group khác: Điều hướng trở lại Security Groups Nhấp Create security group Cấu hình Security Group cho OpenSearch: Security group name: Nhập SG-OpenSearch Description: Nhập Security group for OpenSearch domain access VPC: Chọn NSM-VPC từ danh sách thả xuống Định nghĩa các quy tắc Inbound: Nhấp Add rule Cấu hình quyền truy cập HTTPS cho Bastion: Type: Chọn HTTPS Source: Chọn Custom Chọn ID security group của SG-Bastion bạn vừa tạo Nhấp Add rule một lần nữa Cấu hình quyền truy cập HTTPS cho Firehose: Type: Chọn HTTPS Source: Chọn Custom Chọn ID security group của SG-Firehose bạn vừa tạo Hoàn tất việc tạo security group: Xem lại cài đặt của bạn Nhấp Create security group Xác minh ba security groups: Xác nhận ba security groups xuất hiện trong danh sách của bạn Giờ đây bạn đã có các security groups chuyên dụng cho tài nguyên Bastion, Firehose và OpenSearch "
},
{
	"uri": "//localhost:1313/vi/5-create-and-configure-opensearch-service/",
	"title": "Tạo và cấu hình OpenSearch Service",
	"tags": [],
	"description": "",
	"content": "Tổng quan về Thiết lập OpenSearch Service Trong phần này, chúng ta sẽ triển khai và cấu hình một Amazon OpenSearch Service domain. OpenSearch Service là một dịch vụ được quản lý giúp dễ dàng triển khai, vận hành và mở rộng các OpenSearch cluster trong AWS Cloud. Đối với workshop này, OpenSearch sẽ đóng vai trò là công cụ phân tích và nền tảng tìm kiếm toàn văn bản cho VPC Flow Logs của bạn, cho phép bạn lưu trữ, tìm kiếm và trực quan hóa dữ liệu lưu lượng mạng. Bạn sẽ cấu hình domain để truy cập riêng tư trong VPC của mình và thiết lập một ingest pipeline để phân tích cú pháp dữ liệu nhật ký luồng đến.\nCác khái niệm chính: Amazon OpenSearch Service: Một dịch vụ được quản lý để triển khai, vận hành và mở rộng các OpenSearch clusters. OpenSearch Domain: OpenSearch cluster của bạn, bao gồm các data nodes, storage và cấu hình mạng. Ingest Pipeline: Một chuỗi các bộ xử lý giúp biến đổi tài liệu trước khi chúng được lập chỉ mục trong OpenSearch. Grok Processor: Một công cụ mạnh mẽ trong ingest pipelines được sử dụng để phân tích dữ liệu nhật ký không có cấu trúc thành các trường có cấu trúc. Index Template: Một cách để tự động áp dụng các cài đặt và ánh xạ cho các chỉ mục mới dựa trên các mẫu phù hợp. Mục lục: 5.1 Tạo OpenSearch Service Domain 5.2 Tạo Ingest Pipeline "
},
{
	"uri": "//localhost:1313/vi/2-preparation/6-create-iam-policy-and-iam-role/",
	"title": "Tạo IAM Policy và IAM Role",
	"tags": [],
	"description": "",
	"content": "\rTrong lab này, việc tạo một IAM Policy (NSM-Firehose-Policy) và một IAM Role (NSM-Firehose-Role) chuyên dụng là rất quan trọng để kích hoạt dịch vụ Kinesis Firehose một cách an toàn nhằm tương tác với các tài nguyên AWS khác như S3 và OpenSearch. Điều này đảm bảo rằng Firehose chỉ có các quyền cần thiết để gửi dữ liệu đến các đích đã định mà không cấp quá nhiều đặc quyền, tuân thủ nguyên tắc quyền tối thiểu, điều cần thiết cho một kiến trúc bảo mật.\nTạo IAM Firehose Policy Điều hướng đến IAM Console: Điều hướng đến AWS Management Console Tìm kiếm và chọn IAM trong thanh tìm kiếm dịch vụ Bắt đầu tạo policy: Điều hướng đến Policies trong ngăn điều hướng bên trái Nhấp Create policy Chỉ định quyền: Chọn tab JSON Dán JSON sau vào tab JSON { \u0026#34;Version\u0026#34;: \u0026#34;2012-10-17\u0026#34;, \u0026#34;Statement\u0026#34;: [ { \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Action\u0026#34;: [ \u0026#34;s3:AbortMultipartUpload\u0026#34;, \u0026#34;s3:GetBucketLocation\u0026#34;, \u0026#34;s3:GetObject\u0026#34;, \u0026#34;s3:ListBucket\u0026#34;, \u0026#34;s3:ListBucketMultipartUploads\u0026#34;, \u0026#34;s3:PutObject\u0026#34; ], \u0026#34;Resource\u0026#34;: [ \u0026#34;arn:aws:s3:::*\u0026#34;, \u0026#34;arn:aws:s3:::*/*\u0026#34; ] }, { \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Action\u0026#34;: [ \u0026#34;es:DescribeDomain\u0026#34;, \u0026#34;es:DescribeDomains\u0026#34;, \u0026#34;es:DescribeDomainConfig\u0026#34;, \u0026#34;es:ESHttpPost\u0026#34;, \u0026#34;es:ESHttpPut\u0026#34;, \u0026#34;es:ESHttpGet\u0026#34; ], \u0026#34;Resource\u0026#34;: [ \u0026#34;arn:aws:es:*:*:domain/*\u0026#34; ] }, { \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Action\u0026#34;: [ \u0026#34;ec2:DescribeVpcs\u0026#34;, \u0026#34;ec2:DescribeVpcAttribute\u0026#34;, \u0026#34;ec2:DescribeSubnets\u0026#34;, \u0026#34;ec2:DescribeSecurityGroups\u0026#34;, \u0026#34;ec2:DescribeNetworkInterfaces\u0026#34;, \u0026#34;ec2:CreateNetworkInterface\u0026#34;, \u0026#34;ec2:CreateNetworkInterfacePermission\u0026#34;, \u0026#34;ec2:DeleteNetworkInterface\u0026#34; ], \u0026#34;Resource\u0026#34;: \u0026#34;*\u0026#34; }, { \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Action\u0026#34;: [ \u0026#34;logs:PutLogEvents\u0026#34; ], \u0026#34;Resource\u0026#34;: [ \u0026#34;arn:aws:logs:*:*:log-group:/aws/kinesisfirehose/*:*\u0026#34; ] } ] } Nhấp Next: Cấu hình chi tiết policy: Policy name: Nhập NSM-Firehose-Policy Xem lại và tạo Nhấp Create policy Xác minh việc tạo thành công: Bạn sẽ thấy một thông báo thành công Security group mới của bạn sẽ được thêm vào danh sách Tạo IAM Firehose Roles Tạo một role mới: Trong ngăn điều hướng bên trái, chọn Roles Nhấp Create role Chọn thực thể đáng tin cậy: Trusted entity type: Chọn AWS service Use case: Tìm kiếm và chọn Firehose Nhấp Next Thêm quyền: Tìm kiếm và chọn Policy tùy chỉnh của bạn: NSM-Firehose-Policy Nhấp Next Cấu hình chi tiết role: Role name: Nhập NSM-Firehose-Role Description: Nhập Allows Firehose to deliver data to OpenSearch and S3 Xem lại trust policy và quyền Xem lại và tạo: Xác minh tất cả các cấu hình là chính xác Nhấp Create role Xác nhận việc tạo role: Bạn sẽ thấy một thông báo thành công Role hiện đã sẵn sàng để sử dụng "
},
{
	"uri": "//localhost:1313/vi/6-create-kinesis-data-firehose/",
	"title": "Tạo Kinesis Data Firehose",
	"tags": [],
	"description": "",
	"content": "\rTrong phần này, bạn sẽ tạo và cấu hình một Amazon Kinesis Data Firehose delivery stream. Luồng Firehose này là một thành phần quan trọng sẽ tự động thu thập, chuyển đổi và tải dữ liệu VPC Flow Logs của bạn từ một nguồn Direct PUT vào Amazon OpenSearch Service domain của bạn và cũng sao lưu dữ liệu vào S3 bucket của bạn. Firehose đơn giản hóa quá trình truyền dữ liệu đáng tin cậy đến các đích khác nhau, đảm bảo rằng dữ liệu đo lường mạng của bạn được thu thập hiệu quả và sẵn sàng để phân tích.\nTạo Kinesis Data Firehose Delivery Stream Đăng nhập vào AWS Management Console Trong thanh tìm kiếm, gõ Firehose Chọn Amazon Data Firehose từ danh sách dịch vụ Tạo luồng Firehose Chọn Firehose streams từ ngăn điều hướng bên trái Nhấp Create Firehose stream Chọn nguồn và đích Source: Chọn Direct PUT Destination: Chọn Amazon OpenSearch Service Firehose stream name: Nhập NSM-FlowLogs-Firehose Cấu hình cài đặt đích OpenSearch Service domain: Nhấp Browse Chọn nsm-opensearch và nhấp Choose Index: Nhập vpc-flow-logs Index rotation: Chọn Every day Kết nối VPC đích VPC: NSM-VPC Subnets: NSM-Private-Subnet Security groups: Chọn SG-Firehose Cài đặt sao lưu Source record backup in Amazon S3: Chọn All data S3 backup bucket: Nhấp Browse Chọn S3 Bucket của bạn (nsm-flow-logs-YYYYMMDD) và nhấp Choose S3 prefix flow-logs/year=!{timestamp:yyyy}/month=!{timestamp:MM}/day=!{timestamp:dd}/hour=!{timestamp:HH}/ S3 error output prefix: errors/ Cài đặt Nâng cao Service access Chọn Choose existing IAM role Chọn NSM-Firehose-Role từ danh sách thả xuống Tạo Nhấp Create delivery stream ở cuối trang Chờ cho trạng thái luồng phân phối thay đổi thành Active "
},
{
	"uri": "//localhost:1313/vi/7-create-vpc-flow-log/",
	"title": "Tạo VPC Flow Log",
	"tags": [],
	"description": "",
	"content": "\rTrong phần này, bạn sẽ cấu hình VPC Flow Logs để thu thập thông tin chi tiết về lưu lượng IP đến và đi từ các giao diện mạng trong Virtual Private Cloud (VPC) của bạn. Đây là một bước quan trọng để giám sát mạng, phân tích bảo mật và khắc phục sự cố trong môi trường AWS của bạn. VPC Flow Logs sẽ được cấu hình để gửi tất cả dữ liệu lưu lượng truy cập trực tiếp đến Kinesis Data Firehose stream mà bạn đã thiết lập trước đó, đảm bảo việc đưa dữ liệu vào OpenSearch Service domain của bạn theo thời gian thực để phân tích và trực quan hóa ngay lập tức.\nTạo VPC Flow Log để Giám sát Mạng Điều hướng đến AWS Management Console Trong thanh tìm kiếm, tìm và chọn VPC Tạo flow log Chọn NSM-VPC của bạn Chọn tab Flow logs Nhấp Create flow log Cấu hình flow log: Filter: All (thu thập tất cả lưu lượng truy cập) Maximum aggregation interval: 1 minute Destination: Send to Amazon Data Firehose in the same account Firehose delivery stream: Chọn NSM-FlowLogs-Firehose từ danh sách thả xuống Log format: AWS default format Nhấp Create flow log "
},
{
	"uri": "//localhost:1313/vi/8-verify-data-flow-and-create-dashboard/",
	"title": "Xác minh luồng dữ liệu và tạo Dashboard",
	"tags": [],
	"description": "",
	"content": "Tổng quan về Xác minh Luồng Dữ liệu và Tạo Dashboard Trong phần này, chúng ta sẽ xác minh luồng dữ liệu VPC Flow Logs từ nguồn đến Amazon OpenSearch Service và tạo một bảng điều khiển để trực quan hóa dữ liệu này. Đây là bước cuối cùng để đảm bảo toàn bộ kiến trúc giám sát mạng của bạn đang hoạt động chính xác, cho phép bạn dễ dàng tìm kiếm, phân tích và giám sát lưu lượng mạng trong VPC của mình thông qua các biểu đồ và số liệu tùy chỉnh.\nCác khái niệm chính: Amazon OpenSearch Service: Một dịch vụ được quản lý để triển khai, vận hành và mở rộng các OpenSearch clusters. OpenSearch Dashboards: Giao diện người dùng dựa trên web cho OpenSearch để trực quan hóa và quản lý dữ liệu. Index Pattern: Một mẫu được sử dụng trong OpenSearch Dashboards để xác định các chỉ mục bạn muốn khám phá và trực quan hóa. Discover: Một tính năng của OpenSearch Dashboards cho phép bạn tìm kiếm, lọc và khám phá dữ liệu thô. Visualization: Các biểu đồ và đồ thị được tạo từ dữ liệu trong OpenSearch để trình bày thông tin một cách trực quan. Dashboard: Một tập hợp các visualization được sắp xếp trên một trang duy nhất để cung cấp cái nhìn tổng quan về dữ liệu. Mục lục: 8.1 Xác minh luồng dữ liệu 8.2 Tạo Dashboard "
},
{
	"uri": "//localhost:1313/vi/9-query-logs-with-athena/",
	"title": "Truy vấn nhật ký với Athena",
	"tags": [],
	"description": "",
	"content": "\rTrong phần này, bạn sẽ sử dụng Amazon Athena để truy vấn các VPC Flow Logs được lưu trữ trong S3 bucket của bạn. Athena là một dịch vụ truy vấn tương tác giúp dễ dàng phân tích dữ liệu trực tiếp trong Amazon S3 bằng cách sử dụng SQL tiêu chuẩn. Bước này trình bày cách thực hiện phân tích đặc biệt hiệu quả trên dữ liệu nhật ký luồng thô của bạn, cung cấp một phương pháp thay thế hoặc bổ sung cho OpenSearch để điều tra chuyên sâu và báo cáo tùy chỉnh về lưu lượng mạng của bạn.\nTruy vấn VPC Flow Logs bằng Amazon Athena Cấu hình Vị trí Kết quả Truy vấn Athena\nĐiều hướng đến Athena Console Thiết lập lần đầu: Nếu đây là lần đầu tiên của bạn, hãy nhấp vào \u0026ldquo;Explore the query editor\u0026rdquo; Nhấp vào tab Settings ở trên cùng Nhấp Manage Nhập vị trí S3: s3://nsm-flow-logs-YYYYMMDD/athena-results/ (thay thế nsm-flow-logs-YYYYMMDD bằng tên bucket thực tế của bạn)\nNhấp Save Tạo Cơ sở dữ liệu\nTrong Query Editor của Athena, chạy lệnh này: CREATE DATABASE IF NOT EXISTS vpc_flow_logs_db; Tạo Bảng VPC Flow Logs\nChạy lệnh này CREATE EXTERNAL TABLE vpc_flow_logs_db.vpc_flow_logs ( version int, account_id string, interface_id string, srcaddr string, dstaddr string, srcport int, dstport int, protocol int, packets bigint, bytes bigint, windowstart bigint, windowend bigint, action string, flowlogstatus string ) ROW FORMAT DELIMITED FIELDS TERMINATED BY \u0026#39; \u0026#39; LOCATION \u0026#39;s3://nsm-flow-logs-20250727/flow-logs/\u0026#39; TBLPROPERTIES ( \u0026#39;skip.header.line.count\u0026#39;=\u0026#39;0\u0026#39; ); Xác minh việc tạo bảng\nSHOW TABLES; Kiểm tra với các truy vấn mẫu\nKhám phá dữ liệu cơ bản -- Xem 10 bản ghi đầu tiên để hiểu cấu trúc dữ liệu của bạn SELECT * FROM vpc_flow_logs LIMIT 10; Đếm tổng số bản ghi -- Đếm tổng số bản ghi nhật ký luồng SELECT COUNT(*) as total_records FROM vpc_flow_logs; Kiểm tra chất lượng dữ liệu -- Kiểm tra các hành động khác nhau trong nhật ký của bạn SELECT action, COUNT(*) as count FROM vpc_flow_logs GROUP BY action; Các truy vấn ví dụ để phân tích\nPhân tích lưu lượng SSH (Cổng 22) -- Tìm các lần thử kết nối SSH SELECT srcaddr, dstaddr, action, packets, bytes, from_unixtime(windowstart) as start_time, from_unixtime(windowend) as end_time FROM vpc_flow_logs WHERE dstport = 22 ORDER BY windowstart DESC LIMIT 20; Phân tích các kết nối bị từ chối -- Phân tích các kết nối bị từ chối SELECT srcaddr, dstaddr, dstport, COUNT(*) as rejected_count FROM vpc_flow_logs WHERE action = \u0026#39;REJECT\u0026#39; GROUP BY srcaddr, dstaddr, dstport ORDER BY rejected_count DESC LIMIT 15; Xem kết quả truy vấn trong S3\nĐiều hướng đến https://s3.console.aws.amazon.com/ Điều hướng đến bucket: nsm-flow-logs-YYYY-MM-DD Mở thư mục: athena-results/ "
},
{
	"uri": "//localhost:1313/vi/10-clean-up-resources/",
	"title": "Dọn dẹp tài nguyên",
	"tags": [],
	"description": "",
	"content": "\rTrong phần cuối cùng này, bạn sẽ tìm hiểu cách dọn dẹp đúng cách tất cả các tài nguyên AWS đã được cấp phát trong suốt bài lab này. Điều quan trọng là phải xóa các tài nguyên này để tránh phát sinh chi phí không cần thiết và để duy trì một tài khoản AWS gọn gàng. Hướng dẫn từng bước này đảm bảo rằng bạn loại bỏ một cách có hệ thống tất cả các thành phần của giải pháp giám sát mạng, từ Firehose streams và EC2 instances đến OpenSearch domains, VPCs, S3 buckets và IAM roles/policies.\nXóa Firehose Stream Điều hướng đến https://us-east-1.console.aws.amazon.com/firehose Chọn luồng NSM-FlowLogs-Firehose Nhấp Delete Gõ NSM-FlowLogs-Firehose và nhấp Delete Xóa Bastion Host Điều hướng đến https://us-east-1.console.aws.amazon.com/ec2/home?region=us-east-1#Instances Chọn NSM-Bastion-Host Nhấp Instance state → Terminate (delete) instance Nhấp Terminate (delete) Xóa OpenSearch Domain Điều hướng đến https://us-east-1.console.aws.amazon.com/aos/home?region=us-east-1#opensearch/dashboard Chọn nsm-opensearch Nhấp Delete Gõ nsm-opensearch và nhấp Delete Đợi cho opensearch domain xóa thành công Xóa VPC Điều hướng đến https://us-east-1.console.aws.amazon.com/vpcconsole/home?region=us-east-1#vpcs: Chọn NSM-VPC Nhấp Actions → Delete VPC Gõ delete và nhấp Delete Xóa Elastic IP Chọn Elastic IP từ bảng điều hướng bên trái Chọn Elastic IP Nhấp Actions → Release Elastic IP addresses → Release Xóa S3 Bucket Điều hướng đến https://us-east-1.console.aws.amazon.com/s3 Chọn bucket của bạn (nsm-flow-logs-YYYYMMDD) → Nhấp Empty Gõ permanently delete → Empty Nhấp Exit Chọn lại bucket của bạn (nsm-flow-logs-YYYYMMDD) → Nhấp Delete Gõ tên bucket của bạn → Nhấp Delete bucket Xóa IAM Role và IAM Policy Điều hướng đến https://us-east-1.console.aws.amazon.com/iam Chọn Role từ bảng điều hướng bên trái Chọn NSM-Firehose-Role Nhấp Delete Gõ NSM-Firehose-Role → Nhấp Delete Chọn Policies từ bảng điều hướng bên trái Tìm kiếm và chọn NSM-Firehose-Policy Nhấp Delete Gõ NSM-Firehose-Policy → Nhấp Delete "
},
{
	"uri": "//localhost:1313/vi/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "//localhost:1313/vi/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]